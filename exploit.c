#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
#include "shellcode.h"

void (*sc)();
int main()
{
	void *ptr;
	ptr = mmap(0, shellcode_bin_len, PROT_EXEC | PROT_WRITE | PROT_READ, MAP_ANON | MAP_PRIVATE, -1, 0);
	if (ptr == MAP_FAILED) {
		printf("mmap failed.\n");
		return 0;
	}
	memcpy(ptr, shellcode_bin, shellcode_bin_len);
	sc = ptr;
	sc();
	printf("OK.\n");
	return 0;
}

